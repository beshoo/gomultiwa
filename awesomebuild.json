{
    "main": "build",
    "project": "gomultiwa",
    "rules": {
        "build": {
            "callBefore": [
                "prepare-output",
                "get-dependencies"
            ],
            "cmd": [
                {
                    "cmd": "GO111MODULE=on packr2 build -o output/gomultiwa cmd/gomultiwa/main.go",
                    "type": "cmd"
                },
                {
                    "cmd": "GO111MODULE=on go build -o output/gomultiwa cmd/gomultiwa/main.go",
                    "type": "cmd"
                },
                {
                    "cmd": "cp cmd/gomultiwa/output/gomultiwa output",
                    "type": "cmd"
                }
            ],
            "trigger": [
                {
                    "subtype": "changed",
                    "type": "directory",
                    "value": "internal"
                },
                {
                    "subtype": "not exist",
                    "type": "file",
                    "value": "output/gomultiwa"
                }
            ]
        },
        "get-dependencies": {
            "cmd": [
                {
                    "cmd": "GO111MODULE=on go mod tidy",
                    "type": "cmd"
                },
                {
                    "cmd": "rm -rf vendor",
                    "type": "cmd"
                },
                {
                    "cmd": "GO111MODULE=on go mod vendor",
                    "type": "cmd"
                }
            ],
            "trigger": {
                "subtype": "changed",
                "type": "directory",
                "value": "internal"
            }
        },
        "prepare-output": {
            "cmd": [
                {
                    "cmd": "mkdir -p output",
                    "type": "cmd"
                }
            ],
            "trigger": {
                "subtype": "not exist",
                "type": "directory",
                "value": "output"
            }
        }
    }
}